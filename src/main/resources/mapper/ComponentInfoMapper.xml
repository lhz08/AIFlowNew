<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bdilab.aiflow.mapper.ComponentInfoMapper">
  <resultMap id="ComponentInfoMap" type="com.bdilab.aiflow.model.ComponentInfo">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sun Aug 30 16:18:08 CST 2020.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="tags" jdbcType="VARCHAR" property="tags" />
    <result column="is_custom" jdbcType="TINYINT" property="isCustom" />
    <result column="component_yaml_addr" jdbcType="VARCHAR" property="componentYamlAddr" />
    <result column="input_stub" jdbcType="VARCHAR" property="inputStub" />
    <result column="output_stub" jdbcType="VARCHAR" property="outputStub" />
    <result column="graph_type_ids" jdbcType="VARCHAR" property="graphTypeIds" />
    <result column="component_desc" jdbcType="LONGVARCHAR" property="componentDesc" />
  </resultMap>

  <insert id="insertComponentInfo" useGeneratedKeys="true" keyProperty="id" parameterType="com.bdilab.aiflow.model.ComponentInfo">
    INSERT INTO component_info
        (id, name, tags, is_custom, component_yaml_addr,
        input_stub, output_stub, graph_type_ids, component_desc)
    VALUE (#{id}, #{name}, #{tags}, #{isCustom}, #{componentYamlAddr},
        #{inputStub}, #{outputStub}, #{graphTypeIds}, #{componentDesc})
  </insert>

  <select id="selectComponentYamlAddr" parameterType="java.util.List" resultType="java.lang.String">
    SELECT component_yaml_addr FROM component_info
    WHERE component_info.id in
    <foreach collection="list" item="id" separator="," open="(" close=")">
      #{id}
    </foreach>
  </select>

  <delete id="deleteComponentPermanently" parameterType="java.util.List">
    DELETE FROM component_info
    WHERE id in
    <foreach collection="list" item="id" separator="," open="(" close=")">
      #{id}
    </foreach>
  </delete>

  <select id="selectComponentInfoById" parameterType="Integer" resultType="com.bdilab.aiflow.model.ComponentInfo">
          select component_info.id as id,
                 component_info.name as name,
                 component_info.tags as tags,
                 component_info.is_custom as isCustom,
                 component_info.component_yaml_addr as componentYamlPath,
                 component_info.input_stub as inputStub,
                 component_info.output_stub as outputStub
          from component_info
          where component_info.id = #{id}
  </select>

    <select id="loadPublicComponentInfo" resultType="com.bdilab.aiflow.model.ComponentInfo">
        SELECT component_info.id as id,
                 component_info.name as name,
                 component_info.tags as tags,
                 component_info.is_custom as isCustom,
                 component_info.input_stub as inputStub,
                 component_info.output_stub as outputStub
        from component_info
          where component_info.is_custom = 0
    </select>

</mapper>